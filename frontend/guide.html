<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Guide Registration</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial; margin: 0; background: #f7fafc; color: #1a202c; }
        .navbar { background: linear-gradient(90deg, #0057b8, #00aaff); box-shadow: 0 3px 8px rgba(0,0,0,0.15); }
        .navbar .navbar-brand, .navbar .nav-link { color: #fff !important; }
        .navbar .nav-link:hover { color: #ffe066 !important; }
        .navbar-toggler { border: none; }
        .navbar-toggler-icon { background-image: url('data:image/svg+xml;charset=utf8,%3Csvg viewBox="0 0 30 30" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath stroke="white" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M4 7h22M4 15h22M4 23h22"/%3E%3C/svg%3E'); }
        .container { max-width: 720px; margin: 48px auto; padding: 24px; background: #fff; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.06); }
        h1 { margin-top: 0; font-size: 28px; }
        form { display: grid; gap: 16px; }
        .row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
        label { font-weight: 600; font-size: 14px; }
        input, select, textarea { width: 100%; padding: 12px 14px; border: 1px solid #e2e8f0; border-radius: 8px; background: #fff; }
        button { padding: 12px 16px; background: #2563eb; color: #fff; border: 0; border-radius: 8px; font-weight: 600; cursor: pointer; }
        button:disabled { opacity: .7; cursor: not-allowed; }
        .note { color: #4a5568; font-size: 13px; }
        .list { margin-top: 24px; }
        .card { border: 1px solid #e2e8f0; border-radius: 10px; padding: 14px; margin-bottom: 10px; }
        .error { color: #b91c1c; }
        .success { color: #065f46; }
        a { color: #2563eb; text-decoration: none; }
    </style>
    <script>
        async function submitGuide(event) {
            event.preventDefault();
            const submitButton = document.getElementById('submitBtn');
            const message = document.getElementById('message');
            message.textContent = '';
            message.className = '';

            const formData = new FormData(event.target);
            const payload = {
                name: formData.get('name'),
                username: formData.get('username'),
                email: formData.get('email'),
                destination: formData.get('destination'),
                languages: formData.get('languages')
            };

            try {
                submitButton.disabled = true;
                const res = await fetch('/api/guides', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const data = await res.json();
                if (!res.ok) throw new Error(data.message || 'Failed');
                message.textContent = 'Guide saved successfully';
                message.className = 'success';
                event.target.reset();
                // Redirect to guide details page after 1 second
                setTimeout(() => {
                    window.location.href = 'guide-details.html';
                }, 1000);
            } catch (err) {
                message.textContent = err.message;
                message.className = 'error';
            } finally {
                submitButton.disabled = false;
            }
        }

    </script>
  </head>
  <body>
    <div id="navbar-host"></div>
    <div class="container" style="margin-top: 80px;">
        <h1>Register a Guide</h1>
        <p class="note">Fill in the details: name, username, email, destination, and languages (comma separated).</p>
        <form onsubmit="submitGuide(event)">
            <div class="row">
                <div>
                    <label for="name">Name</label>
                    <input id="name" name="name" type="text" placeholder="John Doe" required />
                </div>
                <div>
                    <label for="username">Username</label>
                    <input id="username" name="username" type="text" placeholder="johnd" required />
                </div>
            </div>
            <div class="row">
                <div>
                    <label for="email">Email</label>
                    <input id="email" name="email" type="email" placeholder="john@example.com" required />
                </div>
                <div>
                    <label for="destination">Destination</label>
                    <input id="destination" name="destination" type="text" placeholder="Munnar" required />
                </div>
            </div>
            <div>
                <label for="languages">Languages (comma separated)</label>
                <input id="languages" name="languages" type="text" placeholder="English, Hindi, Malayalam" required />
            </div>
            <div>
                <button id="submitBtn" type="submit">Save Guide</button>
                <span id="message" style="margin-left:12px"></span>
            </div>
        </form>

        <div class="text-center mt-4">
            <a href="guide-details.html" class="btn btn-outline-primary">View All Guides</a>
            <p class="note mt-3">Go back to <a href="/dashboard.html">Dashboard</a></p>
        </div>
    </div>
    <script src="/js/auth.js"></script>
    <script src="/js/navbar.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
  </html>


